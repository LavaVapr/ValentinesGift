<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Be My Valentine? üíï</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            min-height: 100vh;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            /* Solid fallback color if image doesn't load */
            background-color: #ffb3d9 !important;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            min-height: 100vh !important;
            position: relative;
            overflow: hidden;
        }

        /* Background layer that will animate */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://i.imgur.com/c1ERMrv.jpg?v=2');
            background-size: cover;
            background-position: 5% center;
            background-repeat: no-repeat;
            z-index: -1;
        }

        /* Mobile only - slide background from left to right every 24 seconds total */
        @media (max-width: 768px) {
            body::before {
                animation: backgroundSlide 24s ease-in-out infinite;
            }
        }

        @keyframes backgroundSlide {
            0% {
                background-position: 5% center;
            }
            8.33% { /* 2 seconds to slide right (2/24 = 8.33%) */
                background-position: 85% center;
            }
            41.67% { /* Stay at right for 8 seconds (10/24 = 41.67%) */
                background-position: 85% center;
            }
            50% { /* 2 seconds to slide back left (12/24 = 50%) */
                background-position: 5% center;
            }
            91.67% { /* Stay at left for 8 seconds (22/24 = 91.67%) */
                background-position: 5% center;
            }
            100% { /* Ready to start next cycle */
                background-position: 5% center;
            }
        }

        /* Floating hearts animation */
        .heart {
            position: absolute;
            font-size: 2rem;
            opacity: 0;
            animation: float 6s infinite ease-in-out;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0;
            }
            5% {
                opacity: 0.6;
            }
            95% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .container {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem 1.5rem;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            position: relative;
            z-index: 10;
        }

        h1 {
            color: #ff1654;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 4px rgba(255, 22, 84, 0.2);
        }

        .question-screen {
            display: block;
        }

        .answer-screen {
            display: none;
        }

        .button-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            -webkit-tap-highlight-color: transparent;
        }

        .btn-yes {
            background: linear-gradient(135deg, #ff6b9d, #ff1654);
            color: white;
            transform: scale(1);
        }

        .btn-yes:active {
            transform: scale(0.95);
        }

        .btn-no {
            background: linear-gradient(135deg, #9e9e9e, #757575);
            color: white;
            transform: scale(1);
        }

        .btn-no:active {
            transform: scale(0.95);
        }

        .media-container {
            margin: 1.5rem 0;
            max-width: 100%;
        }

        .media-container img,
        .media-container video {
            max-width: 100%;
            max-height: 400px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .answer-text {
            font-size: 1.1rem;
            color: #333;
            margin-top: 1.5rem;
            line-height: 1.6;
        }

        /* Loading Screen Styles */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffb3d9 !important;
            background-image: url('https://i.imgur.com/c1ERMrv.jpg?v=2') !important;
            background-size: cover !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            padding: 1rem;
        }

        .loading-content {
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem 1.5rem;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .loading-text {
            font-size: 1rem;
            color: #333;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .ok-btn {
            background: linear-gradient(135deg, #ff6b9d, #ff1654);
            color: white;
            border: none;
            padding: 12px 40px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .ok-btn:active {
            transform: scale(0.95);
        }

        /* Audio Player Styles */
        .audio-player {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.95);
            padding: 0.8rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }

        .audio-player-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .audio-player button {
            background: linear-gradient(135deg, #ff6b9d, #ff1654);
            color: white;
            border: none;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.9rem;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            -webkit-tap-highlight-color: transparent;
        }

        .audio-player button:active {
            transform: scale(0.9);
        }

        .audio-player button.play-btn {
            width: 45px;
            height: 45px;
            font-size: 1rem;
        }

        .audio-player input[type="range"] {
            flex: 1;
            cursor: pointer;
            -webkit-appearance: none;
            height: 4px;
            border-radius: 2px;
            background: #ddd;
        }

        .audio-player input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #ff1654;
            cursor: pointer;
        }

        .audio-track-info {
            font-size: 0.85rem;
            color: #333;
            margin-bottom: 8px;
            font-weight: bold;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .audio-time {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #666;
            margin-top: 5px;
        }

        /* Volume control - visible on all devices */
        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-text">Tap OK to start the music! üéµ</div>
            <button class="ok-btn" onclick="dismissLoading()">OK</button>
        </div>
    </div>

    <div class="container">
        <!-- Question Screen -->
        <div class="question-screen" id="questionScreen">
            <h1>Will you be my Valentine? üíò</h1>
            <div class="button-container">
                <button class="btn btn-yes" id="yesBtn">Yes! üíï</button>
                <button class="btn btn-no" id="noBtn">No</button>
            </div>
        </div>

        <!-- Answer Screen (shown when Yes is clicked) -->
        <div class="answer-screen" id="answerScreen">
            <h1>watch this babe üòº</h1>
            <div class="media-container" id="mediaContainer"></div>
            <div class="answer-text" id="answerText">I told you, you don't have a choice</div>
            
            <button class="btn btn-no" onclick="goBack()" style="margin-top: 2rem;">‚Üê Go Back</button>
        </div>
    </div>

    <!-- Audio Player - Only visible on question screen -->
    <div class="audio-player" id="audioPlayer">
        <div class="audio-track-info" id="trackInfo">Track 1</div>
        <div class="audio-player-controls">
            <button onclick="prevTrack()">‚èÆ</button>
            <button class="play-btn" onclick="togglePlay()" id="playBtn">‚ñ∂</button>
            <button onclick="nextTrack()">‚è≠</button>
            <div class="volume-control">
                <span style="font-size: 1rem;">üîä</span>
                <input type="range" min="0" max="100" value="50" id="volume" oninput="changeVolume()">
            </div>
        </div>
        <div style="margin-top: 10px;">
            <input type="range" min="0" max="100" value="0" id="progress" oninput="updateProgress()" style="width: 100%;">
        </div>
        <div class="audio-time">
            <span id="currentTime">0:00</span>
            <span id="duration">0:00</span>
        </div>
    </div>

    <audio id="audioElement" preload="auto"></audio>

    <script>
        // ====== CUSTOMIZE YOUR "NO" BUTTON RESPONSES HERE ======
        const noResponses = [
            "Are you sure?",
            "Really?",
            "Try again",
            "mmm no",
            "WHYYY",
            "STOP IT!",
            "DONT PRESS!",
            "PLEASEE",
            "You dont get a choice",
            "meow"
        ];
        // ======================================================

        let noClickCount = 0;
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');
        const questionScreen = document.getElementById('questionScreen');
        const answerScreen = document.getElementById('answerScreen');
        
        // Button messages that cycle
        const buttonMessages = ["I love you üíï", "Hehehe", "You're cute", "Hey gorgeous"];
        let messageIndex = 0;

        // Create floating hearts
        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (Math.random() * 3 + 3) + 's';
            heart.style.animationDelay = Math.random() * 2 + 's';
            document.body.appendChild(heart);
            
            setTimeout(() => {
                heart.remove();
            }, 6000);
        }

        // Create hearts periodically
        setInterval(createHeart, 800);

        // No button click handler
        noBtn.addEventListener('click', function(e) {
            e.preventDefault();
            if (noClickCount < noResponses.length) {
                noBtn.textContent = noResponses[noClickCount];
                
                const newNoScale = 1 - (noClickCount + 1) * 0.1;
                noBtn.style.transform = `scale(${Math.max(newNoScale, 0.3)})`;
                
                const newYesScale = 1 + (noClickCount + 1) * 0.15;
                yesBtn.style.transform = `scale(${newYesScale})`;
                
                noClickCount++;
                
                if (noClickCount >= noResponses.length) {
                    noBtn.style.display = 'none';
                }
            }
        });

        // Yes button click handler
        yesBtn.addEventListener('click', function(e) {
            e.preventDefault();
            questionScreen.style.display = 'none';
            answerScreen.style.display = 'block';
            audioPlayerDiv.style.display = 'none';
            
            // Fade out audio
            fadeOutAudio();
            
            // Set the video
            const mediaContainer = document.getElementById('mediaContainer');
            const embedUrl = "https://player.vimeo.com/video/1164928202?badge=0&autopause=0&autoplay=1";
            mediaContainer.innerHTML = `<iframe width="100%" height="450" src="${embedUrl}" frameborder="0" allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media" style="border-radius: 15px;"></iframe>`;
            
            // Create celebration hearts
            for (let i = 0; i < 20; i++) {
                setTimeout(createHeart, i * 100);
            }
        });

        // Audio Player Functionality
        const audioPlayer = document.getElementById('audioElement');
        const playBtn = document.getElementById('playBtn');
        const progress = document.getElementById('progress');
        const volumeSlider = document.getElementById('volume');
        const trackInfo = document.getElementById('trackInfo');
        const currentTimeDisplay = document.getElementById('currentTime');
        const durationDisplay = document.getElementById('duration');
        const audioPlayerDiv = document.getElementById('audioPlayer');

        // Audio tracks - using relative paths
        const tracks = [
            { name: "Krystal", url: "./Krystal.mp3" },
            { name: "When My Life Is Over", url: "./WhenMyLifeIsOver.mp3" },
            { name: "The Mar√≠as - Nobody New", url: "./TheMariasNobodyNew.mp3" },
            { name: "Everyone Adores You (at least I do)", url: "./EveryoneAdoresYouatleastIdo.mp3" },
            { name: "Matt Maltese - As the World Caves In", url: "./MattMalteseAstheWorldCavesInOfficial.mp3" },
            { name: "The Ronettes - Be My Baby", url: "./TheRonettesBeMyBabyOfficialAudio.mp3" },
            { name: "What More Can I Say", url: "./WhatMoreCanISay.mp3" },
            { name: "The Mar√≠as - No One Noticed", url: "./TheMariasNoOneNoticed.mp3" },
            { name: "Last Night on Earth - Green Day", url: "./SubThaiLastNightonEarthGreenDay.mp3" },
            { name: "Come Back! Buddha REMASTERED", url: "./ComeBackBuddhaREMASTERED.mp3" },
            { name: "She & Him - I Thought I Saw Your Face Today", url: "./SheAndHimIThoughtISawYourFaceToday.mp3" }
        ];

        let currentTrack = 0;
        let userHasInteracted = false;
        let savedVolume = 50; // Default 50% of max (which is 10% actual volume)

        // Load first track
        function loadTrack(index) {
            console.log('Loading track:', tracks[index].name);
            const wasPlaying = !audioPlayer.paused;
            audioPlayer.src = tracks[index].url;
            trackInfo.textContent = tracks[index].name;
            currentTrack = index;
            
            // Only autoplay if user has interacted
            if (wasPlaying && userHasInteracted) {
                const playPromise = audioPlayer.play();
                if (playPromise !== undefined) {
                    playPromise.catch(err => {
                        console.log('Autoplay prevented:', err);
                        playBtn.textContent = '‚ñ∂';
                    });
                }
            }
        }

        // Error handling
        audioPlayer.addEventListener('error', function(e) {
            console.error('Audio error:', audioPlayer.error);
            // Don't alert on first load, only if user tried to play
            if (userHasInteracted) {
                alert('Could not load audio file: ' + tracks[currentTrack].name);
            }
        });

        // Toggle play/pause
        function togglePlay() {
            userHasInteracted = true;
            if (audioPlayer.paused) {
                const playPromise = audioPlayer.play();
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        playBtn.textContent = '‚è∏';
                    }).catch(err => {
                        console.log('Play failed:', err);
                        alert('Could not play audio. The MP3 files may be missing or in wrong location.');
                    });
                }
            } else {
                audioPlayer.pause();
                playBtn.textContent = '‚ñ∂';
            }
        }

        // Next track
        function nextTrack() {
            userHasInteracted = true;
            currentTrack = (currentTrack + 1) % tracks.length;
            loadTrack(currentTrack);
            const playPromise = audioPlayer.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    playBtn.textContent = '‚è∏';
                }).catch(err => console.log('Play error:', err));
            }
        }

        // Previous track
        function prevTrack() {
            userHasInteracted = true;
            currentTrack = (currentTrack - 1 + tracks.length) % tracks.length;
            loadTrack(currentTrack);
            const playPromise = audioPlayer.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    playBtn.textContent = '‚è∏';
                }).catch(err => console.log('Play error:', err));
            }
        }

        // Update progress bar
        let isDragging = false;

        audioPlayer.addEventListener('timeupdate', function() {
            if (!isDragging && audioPlayer.duration) {
                const percent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                progress.value = percent || 0;
            }
            
            currentTimeDisplay.textContent = formatTime(audioPlayer.currentTime);
            durationDisplay.textContent = formatTime(audioPlayer.duration);
        });

        // Progress bar interaction - simplified for mobile
        progress.addEventListener('input', function() {
            isDragging = true;
        });

        progress.addEventListener('change', function() {
            const time = (progress.value / 100) * audioPlayer.duration;
            audioPlayer.currentTime = time;
            isDragging = false;
        });

        // For touch devices
        progress.addEventListener('touchend', function() {
            const time = (progress.value / 100) * audioPlayer.duration;
            audioPlayer.currentTime = time;
            isDragging = false;
        });

        function updateProgress() {
            // Visual update only
        }

        // Change volume - Note: This won't work on iOS, max is 10% of actual volume
        function changeVolume() {
            // Slider goes 0-100, but we map it to 0-10% actual volume
            const volumePercent = volumeSlider.value / 100; // 0 to 1
            const actualVolume = volumePercent * 0.10; // Scale to max 10% (0 to 0.10)
            audioPlayer.volume = actualVolume;
            
            // Save to localStorage so it persists
            try {
                localStorage.setItem('valentineVolume', volumeSlider.value);
                savedVolume = volumeSlider.value;
            } catch (e) {
                console.log('Could not save volume:', e);
            }
        }

        // Format time
        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Auto-play next track when current ends
        audioPlayer.addEventListener('ended', nextTrack);

        // Fade out audio - improved for mobile
        function fadeOutAudio() {
            // Immediately pause and reset volume on mobile for reliability
            if (audioPlayer && !audioPlayer.paused) {
                audioPlayer.pause();
                audioPlayer.currentTime = 0; // Reset to beginning
                playBtn.textContent = '‚ñ∂';
            }
        }

        // Dismiss loading screen and start audio
        function dismissLoading() {
            userHasInteracted = true;
            document.getElementById('loadingScreen').style.display = 'none';
            
            // Load saved volume from localStorage
            try {
                const saved = localStorage.getItem('valentineVolume');
                if (saved !== null) {
                    savedVolume = parseInt(saved);
                    volumeSlider.value = savedVolume;
                }
            } catch (e) {
                console.log('Could not load saved volume:', e);
            }
            
            // Load and play first track
            loadTrack(0);
            // Set volume: slider value / 100 * 0.10 (to get max 10%)
            audioPlayer.volume = (savedVolume / 100) * 0.10;
            
            const playPromise = audioPlayer.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    playBtn.textContent = '‚è∏';
                }).catch(err => {
                    console.log('Initial play failed:', err);
                    playBtn.textContent = '‚ñ∂';
                });
            }
        }

        // Go back button handler
        function goBack() {
            answerScreen.style.display = 'none';
            questionScreen.style.display = 'block';
            audioPlayerDiv.style.display = 'block';
            
            // Stop the video
            const mediaContainer = document.getElementById('mediaContainer');
            mediaContainer.innerHTML = '';
            
            // Hide yes/no buttons
            yesBtn.style.display = 'none';
            noBtn.style.display = 'none';
            
            // Create cycling button
            let loveBtn = document.getElementById('loveBtn');
            if (!loveBtn) {
                loveBtn = document.createElement('button');
                loveBtn.id = 'loveBtn';
                loveBtn.className = 'btn btn-yes';
                loveBtn.onclick = function() {
                    goToVideo();
                };
                document.querySelector('.button-container').appendChild(loveBtn);
            }
            
            loveBtn.textContent = buttonMessages[messageIndex];
            loveBtn.style.display = 'inline-block';
            messageIndex = (messageIndex + 1) % buttonMessages.length;
            
            // Restore audio with saved volume
            audioPlayer.volume = (savedVolume / 100) * 0.10; // Restore to saved volume (max 10%)
            if (audioPlayer.paused && userHasInteracted) {
                audioPlayer.play();
                playBtn.textContent = '‚è∏';
            }
        }
        
        // Function to go to video page
        function goToVideo() {
            questionScreen.style.display = 'none';
            answerScreen.style.display = 'block';
            audioPlayerDiv.style.display = 'none';
            
            fadeOutAudio();
            
            const mediaContainer = document.getElementById('mediaContainer');
            const embedUrl = "https://player.vimeo.com/video/1164928202?badge=0&autopause=0&autoplay=1";
            mediaContainer.innerHTML = `<iframe width="100%" height="450" src="${embedUrl}" frameborder="0" allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media" style="border-radius: 15px;"></iframe>`;
            
            for (let i = 0; i < 20; i++) {
                setTimeout(createHeart, i * 100);
            }
        }

        // Initialize
        loadTrack(0);
    </script>
</body>
</html>
